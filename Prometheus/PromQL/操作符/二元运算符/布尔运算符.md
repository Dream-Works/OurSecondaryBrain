---
tags:
  - PromQL
---
[[Prometheus]] 支持以下布尔运算符：
- `==` 相等
- `!=` 不相等
- `>` 大于
- `<` 小于
- `>=` 大于等于
- `<=` 小于等于

可被应用于
- `scalar/scalar(标量/标量)`
- `vector/scalar(向量/标量)`
- `vector/vector(向量/向量)`

默认情况下布尔预算符只会**根据时间序列中的样本的值**，对时间序列进行过滤。
我们可以通过在运算符后面使用 `bool` 修饰符来改变运算符的默认行为。使用 `bool` 修改符后，布尔运算不会对时间序列进行过滤，而是直接依次瞬时向量中的各个样本数据与标量的比较结果 `0` 或者 `1`。

在两个标量之间进行布尔运算，必须提供 bool 修饰符，得到的结果也是标量，即 `0`(`flase`) 或 `1`(`true`)
例如：
```promql
2 > bool 1  # 结果为 1
```

瞬时向量和标量之间的布尔运算，这个运算符会应用到某个当前时刻的每个时序数据上，如果一个时序数据的样本值与这个标量比较的结果是 `false`，则这个时序数据被丢弃掉，如果是 `true`, 则这个时序数据被保留在结果中。如果提供了 bool 修饰符，那么比较结果是 `0` 的时序数据被丢弃掉，而比较结果是 `1` 的时序数据被保留。例如：

```
http_requests_total > 100 # 结果为 true 或 false
http_requests_total > bool 100 # 结果为 1 或 0
```

瞬时向量与瞬时向量直接进行布尔运算时，同样遵循默认的匹配模式：依次找到与左边向量元素匹配（标签完全一致）的右边向量元素进行相应的操作，如果没找到匹配元素，或者计算结果为 false，则直接丢弃。如果匹配上了，则将左边向量的度量指标和标签的样本数据写入瞬时向量。如果提供了 bool 修饰符，那么比较结果是 `0` 的时序数据被丢弃掉，而比较结果是 `1` 的时序数据（只保留左边向量）被保留。
